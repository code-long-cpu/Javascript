<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/WebAPIs_Day_6.css">
  <title>WebAPIs-day6</title>
</head>

<body>
  <h4 id="P143">🅿️143-🛑API-day6-142-注册页面-短信验证码 （①flag节流阀，②icon占位符Background方法，③::before伪类切换自定义icon勾选框）</h4>
  <form action="" class="P142">
    <div class="nameInfo">
      <input type="text" class="name" placeholder="设置用户名称" name="uname" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="telInfo">
      <input type="text" class="tel" placeholder="输入手机号" name="tel" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="checkCode">
      <input type="text" class="message" placeholder="短信验证码" name="checkcode" autocomplete="off">
      <span class="msg"></span>
      <a class='code' href="javascript:;">发送验证码</a>
    </div>
    <div class="passWordInfo">
      <input type="password" class="password" placeholder="设置6至20位字母、数字和符号组合" name="password" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="Agree">
      <input type="password" class="again" placeholder="请再次输入上面密码" name="password" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="agreeBOx">
      <!-- <input type="checkbox" class="gouxuan"> -->
      <i class="unChecked"></i>
      <p class="agree">已阅读并同意<a href="">《用户服务协议》</a></p>
    </div>
    <button class="next">下 一 步</button>
  </form>
  <script>

    //  0-获取验证码
    const code = document.querySelector('.code');
    let flag = true;
    code.addEventListener('click', function (event) {
      if (flag) {
        flag = false;
        let i = 5;
        code.innerHTML = `${i}秒后重新获取`
        const time = setInterval(function () {
          i--;
          code.innerHTML = `${i}秒后重新获取`
          if (i == 0) {
            clearInterval(time);
            code.innerHTML = `发送验证码`
            flag = true;
          }
        }, 1000)
      }
    })

    // 1-检查用户名字输入格式 用check点击事件
    // 先获name取元素
    const name = document.querySelector('.name');
    name.addEventListener('change', verifynamne);
    // 封装verifynamne函数
    function verifynamne() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = name.nextElementSibling;
      // 制定正则规则
      const reg = /^[a-zA-Z0-9-_]{6,10}$/
      // 验证input与正则是否相等
      if (!reg.test(name.value)) {
        console.log(11);
        span.innerHTML = '输入不合法，请输入6～10位'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    // 2-检查用户手机号输入格式 用check点击事件
    // 先获取元素
    const tel = document.querySelector('.tel');
    tel.addEventListener('change', verifyPhone);
    // 封装verifyPhone函数
    function verifyPhone() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = tel.nextElementSibling;
      // 制定正则规则
      const reg = /^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/
      // 验证input与正则是否相等
      if (!reg.test(tel.value)) {
        // console.log(11);
        span.innerHTML = '输入不合法，请输入11位手机号'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    // 3-检查验证码
    const codeInput = document.querySelector('.message');
    codeInput.addEventListener('change', verifyCode);
    // 封装verifyCode函数
    function verifyCode() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = codeInput.nextElementSibling;
      // 制定正则规则
      const reg = /^\d{6}$/
      // 验证input与正则是否相等
      if (!reg.test(codeInput.value)) {
        // console.log(11);
        span.innerHTML = '输入不合法，请输入6位验证码'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    // 4-检查密码
    const passWord = document.querySelector('.password');
    passWord.addEventListener('change', verifyPassWord);
    // 封装verifyPassWord函数
    function verifyPassWord() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = passWord.nextElementSibling;
      // 制定正则规则
      const reg = /^[a-zA-Z0-9-_]{6,20}$/
      // 验证input与正则是否相等
      if (!reg.test(passWord.value)) {
        // console.log(11);
        span.innerHTML = '输入不合法，请输入6-20密码'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }
    // 5-再次验证密码
    const again = document.querySelector('.again');
    again.addEventListener('change', verifyAgain);
    // 封装verifyPassWord函数
    function verifyAgain() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = again.nextElementSibling;
      // 制定正则规则
      // const reg = /^[a-zA-Z0-9-_]{6,20}$/
      // 验证input与正则是否相等
      if (again.value !== passWord.value) {
        // console.log(11);
        span.innerHTML = '两次输入密码不一致'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    //6-勾选框
    const Check = document.querySelector('.unChecked');
    Check.addEventListener('click', function (e) {
      this.classList.toggle('Checked')
    });

    // 7-button提交功能
    const P_142 = document.querySelector('.P142');
    P_142.addEventListener('submit', function (e) {
      if (!Check.classList.contains('Checked')) {
        alert("请勾选《用户服务协议》")
        e.preventDefault()
      }
      //8-form提交功能
      // console.log(verifynamne())
      // 调用函数拿到return
      if (!verifynamne()) e.preventDefault();
      if (!verifyPhone()) e.preventDefault();
      if (!verifyCode()) e.preventDefault();
      if (!verifyPassWord()) e.preventDefault();
      if (!verifyAgain()) e.preventDefault();

      // location.href = '#P147'
    })


  </script>

  <script>
    // 时间函数
    console.log(1);
    // setInterval(function () { console.log(2) }, 5000)
    console.log(3);

  </script>

  <br>
  <hr>
  <!-- <h4 id="P144">🅿️144-🛑API-day6-143-注册页面-验证用户名模块</h4>
  <br>
  <hr>
  <h4 id="P145">🅿️145-🛑API-day6-144-综合案例-注册页面-手机号密码</h4>
  <br>
  <hr>
  <h4 id="P146">🅿️146-🛑API-day6-145-综合案例-注册页面-我同意模块</h4>
  <br>
  <hr> -->


  <h4 id="P147">🅿️147-🛑API-day6-146-阶段案例-登录页面</h4>
  <div class="P144">
    <div class="box">
      <div class="tab_bar">
        <a href="javascript:;" class="active" data-id="0">账户登录</a>
        <a href="javascript:;" data-id="1">二维码登录</a>
      </div>
      <div class="tab_pane_1">
        <a href="javascript:;" class="telCode">手机验证码登录</a>
        <form action="" class="denglu">
          <div class="userName">
            <input type="text" class="Name" name="UserName" placeholder="设置用户名称" autocomplete="off" required>
            <span class="tip">输入用户名格式错误</span>
          </div>
          <div class="userPassword">
            <input type="text" class="Pass" name="UserPass" placeholder="请输入密码" autocomplete="off" required>
            <span class="tip">输入密码格式不正确</span>
          </div>
          <div class="tongyi">
            <i class="AGree"></i>
            <p class="tongyiText">我已同意<a href="javascript:;">《服务条款》</a>和<a href="javascript:;">《用户协议》</a></p>
          </div>
          <button class="dengluButton">登 录</button>
          <div class="beizhu">
            <a href="javascript:;">忘记密码？</a>
            <a href="javascript:;">免费注册</a>
          </div>
        </form>

      </div>
      <div class="tab_pane_2">
        <div class="image">
          <img src="/icon/Long.jpg" alt="">
        </div>
        <p>请用手机扫码登录</p>
      </div>
    </div>
  </div>
  <script>
    // 1-账户登录与二维码登录切换
    const tab_bar = document.querySelector(".tab_bar")
    const tab_pane_1 = document.querySelector(".tab_pane_1")
    const tab_pane_2 = document.querySelector(".tab_pane_2")
    tab_bar.addEventListener("click", function (e) {
      if (e.target.tagName === 'A') {
        tab_bar.querySelector(".active").classList.remove("active");
        e.target.classList.add("active");

        tab_pane_1.style.display = "none";
        tab_pane_2.style.display = "none";
        if (e.target.dataset.id === "0") tab_pane_1.style.display = "block";
        if (e.target.dataset.id === "1") tab_pane_2.style.display = "block";
      }
    })
    // 2-勾选框
    const AGree = document.querySelector(".AGree");
    AGree.addEventListener("click", function (e) {
      this.classList.toggle('AGreed')
    });

    //3-提交判断勾选框是否勾选,存储用户名
    const denglu = document.querySelector(".denglu");
    const Name = document.querySelector(".Name");
    denglu.addEventListener("submit", function (e) {
      e.preventDefault();
      if (!AGree.classList.contains("AGreed")) {
        return alert("请勾选《服务协议》和《用户协议》")
      }
      localStorage.setItem("user", Name.value);
      location.href = '#P148'

    });
  </script>

  <br>
  <hr>
  <h4 id="P148">🅿️148-🛑API-day6-147-阶段案例-首页制作</h4>
  <div class="shouye">
    <ul class="caidan">
      <li><a href="javascript:;">请先登录</a></li>
      <li><a href="javascript:;">免费注册</a></li>
      <li><a href="javascript:;">我的订单</a></li>
      <li><a href="javascript:;">会员中心</a></li>
      <li><a href="javascript:;">手机版</a></li>
    </ul>
    <div class="main">
      <div class="imgBox">
        <div class="leftImg">
          <img src="/new_imgs/1.jpeg" alt="">
          <div class="layer"></div>
        </div>
        <div class="rightImg">
          <ul class="imgss">
            <li class="activee"><img src="/new_imgs/1.jpeg" alt=""></li>
            <li><img src="" alt=""></li>
            <li><img src="" alt=""></li>
            <li><img src="" alt=""></li>
            <li><img src="" alt=""></li>
          </ul>
        </div>
        <div class="bigImg"></div>
      </div>
    </div>
  </div>
  <script>
    // ①图片资源集
    const tupian = ['/new_imgs/1.jpeg', '/new_imgs/2.jpeg', '/new_imgs/3.jpeg', '/new_imgs/4.jpeg', '/new_imgs/5.jpeg'];

    const imgss = document.querySelectorAll('.imgss li img')

    for (let i = 0; i < tupian.length; i++) {
      imgss[i].src = tupian[i];
    }

    // ②小图片选中，鼠标经过事件:冒泡加排他，绿框框选中小图片们，用mouseover（有事件冒泡）
    const rightImg = document.querySelector('.rightImg');
    const leftImg = document.querySelector('.leftImg');
    const bigImg = document.querySelector('.bigImg');
    rightImg.addEventListener("mouseover", function (e) {
      if (e.target.tagName === 'IMG') {
        // console.log(11)
        // 去除所有既有的active
        this.querySelector('.activee').classList.remove('activee');
        // 当前元素添加新的active
        e.target.parentNode.classList.add('activee');
        // console.log(e.target.src)
        // 中盒子图片等于小盒子 
        leftImg.querySelector('img').src = `${e.target.src}`;
        // 大盒子图片等于小盒子
        bigImg.style.backgroundImage = `url(${e.target.src})`
      }
    })

    // ③中等图片选中，显示大图片（mouseenter和mouseleave）
    // 获取大图片

    leftImg.addEventListener('mouseenter', show);
    leftImg.addEventListener('mouseleave', hide);

    let timeID = 0;
    function show() {
      // console.log(11);
      clearTimeout(timeID)
      bigImg.style.display = 'block';
    }
    function hide() {
      timeID = setTimeout(function () {
        bigImg.style.display = 'none';
      }, 200)
    }

    // ④大图片选中，等待一小会儿消失
    bigImg.addEventListener('mouseenter', show)
    bigImg.addEventListener('mouseleave', hide)

    // ⑤显示黑色遮罩层
    const layer = document.querySelector('.layer');
    leftImg.addEventListener('mouseenter', function () {
      layer.style.display = 'block';
    });
    leftImg.addEventListener('mouseleave', function () {
      layer.style.display = 'none';
    });

    // ⑥移动黑色遮罩层（黑色盒子移动的距离=鼠标位置-左侧盒子的边缘）
    // e.pageX得到鼠标在页面的位置（最大）
    // Bounding得到的是距离窗口可视区的距离（次之）
    // scrollTop是卷去页面的距离（不见的尺寸）
    leftImg.addEventListener("mousemove", function (e) {
      // console.log(e.pageX);
      // console.log(leftImg.getBoundingClientRect().left)
      let x = e.pageX - leftImg.getBoundingClientRect().left;
      let y = e.pageY - leftImg.getBoundingClientRect().top - document.documentElement.scrollTop;
      // console.log(x, y);
      // 黑色遮罩层的移动范围(0至400)
      if (x >= 0 && x <= 400 && y >= 0 && y <= 400) {

        let mx = 0;
        let my = 0;
        if (x < 100) mx = 0;
        if (x > 100 && x <= 300) mx = x - 100;
        if (x > 300) mx = 300 - 100;

        if (y < 100) my = 0;
        if (y > 100 && y <= 300) my = y - 100;
        if (y > 300) my = 300 - 100;

        layer.style.left = mx + 'px';
        layer.style.top = my + 'px';

        // 移动大盒子背景图
        bigImg.style.backgroundPositionX = -2 * mx + 'px';
        bigImg.style.backgroundPositionY = -2 * my + 'px';

      }

    })

    // 以下代码失效：2024-7-29 background不能参与交互时间，只是装饰不是内容，img是内容，可以参与交互事件

  </script>
  <br>
  <hr>

  <h4 id="Ptest">🟡input中的icon实验</h4>
  <form action="" class="test0">
    <label for="test1">
      用户名：<input type="text" class="test1" id="test1"><br>
    </label>
    <label for="test2">
      账 &nbsp&nbsp号：<input type="text" class="test2" id="test2"><br>
    </label>
    <label for="test3">
      密 &nbsp&nbsp码：<input type="text" class="test3" id="test3"><br>
    </label>
    <button class="test4">提交</button>
  </form>



</body>

</html>