<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WebAPIs-day4</title>
  <link rel="stylesheet" href="/WebAPIs_Day_4.css">
</head>

<body>
  <h4 id="P119">ğŸ…¿ï¸119-ğŸ›‘API-day4-118-å€’è®¡æ—¶æ¡ˆä¾‹</h4>
  <div class="countdown">
    <p class="data">ä»Šå¤©ï¼š</p>
    <p class="ads">å¼€ä¸šå€’è®¡æ—¶</p>
    <p class="clock">
      <span id="day">00</span>
      <i>å¤©</i>
      <span id="hour">00</span>
      <i>:</i>
      <span id="min">25</span>
      <i>:</i>
      <span id="second">20</span>
    </p>
    <p class="deadline">2025-9-1 8:00:00 å¼€å­¦</p>
    </form>
  </div>
  <script>

    // â‘ å­˜å…¥æœ¬åœ°å­˜å‚¨
    // localStorage.setItem('Studata', JSON.stringify(Stu));
    // â‘¡è·å–æœ¬åœ°å­˜å‚¨æ•°æ®
    // const Stu = JSON.parse(localStorage.getItem('Studata')) || [];

    const old_info = {
      title: 'å¼€æ°´å€’è®¡æ—¶',

    }
    const old_time = {
      fTime: '2024-9-1 8:00:00'
    }
    const new_info = {};
    const new_time = {};
    // localStorage.setItem('local_info', JSON.stringify(old_info));
    // localStorage.setItem('local_time', JSON.stringify(old_time));
    // localStorage.setItem('local_time', JSON.stringify(new_time));

    const localInfo = JSON.parse(localStorage.getItem('local_info')) || [];

    console.log(localInfo.title)

    // è·å–å…ƒç´ 
    const ads = document.querySelector('.ads')
    const day = document.querySelector('#day');
    const hour = document.querySelector('#hour');
    const min = document.querySelector('#min');
    const second = document.querySelector('#second');
    const data = document.querySelector('.data');
    // ç¼–å†™ä»Šæ—¥æ—¥æœŸå‡½æ•°
    const today = new Date();
    console.log(today);
    const y = today.getFullYear();
    const m = today.getMonth();
    const dd = today.getDate();
    data.innerHTML = `ä»Šæ—¥ï¼š${y}å¹´${m + 1}æœˆ${dd}æ—¥`;

    //ç¼–å†™è®¡åˆ’æ—¥æœŸå‡½æ•°
    // è¿˜æ˜¯ç‚¹å‡»äº‹ä»¶åˆ›å»ºinputæ ‡ç­¾



    // æ·»åŠ è‡ªå®šä¹‰æ ‡é¢˜æ–¹æ³•ï¼Œæ ‡é¢˜clickæ–°å¢inputæ ‡ç­¾
    // é»˜è®¤æ ‡é¢˜æ˜¯æ¥è‡ªæœ¬åœ°å­˜å‚¨çš„
    ads.innerHTML = localInfo.title;
    ads.addEventListener("click", function (e) {
      const inputElement = document.createElement('input');
      inputElement.type = 'text';
      inputElement.value = localInfo.title;
      console.log(inputElement)
      // ç”¨inputElementèŠ‚ç‚¹æ›¿æ¢adsèŠ‚ç‚¹
      ads.parentNode.replaceChild(inputElement, ads);
      // focusäº‹ä»¶åœ¨è¾“å…¥æ¡†æ•è·å…‰æ ‡æ—¶å€™ä¼šäº§ç”Ÿæ¨èæœç´¢ç»“æœ
      // inputElement.focus();
      inputElement.addEventListener("blur", function (e) {
        // adsæ ‡é¢˜èµ‹å€¼ï¼›
        ads.innerHTML = inputElement.value;
        // æ¢å›adsèŠ‚ç‚¹ï¼›
        inputElement.parentNode.replaceChild(ads, inputElement);

        // å°†æ–°æ ‡é¢˜å­˜å…¥æœ¬åœ°å­˜å‚¨

        new_info.title = inputElement.value;
        // new_info.fTime = '2024/9/1 8:00:00';

        // console.log(inputElement.value)
        localStorage.setItem('local_info', JSON.stringify(new_info));
        // console.log(local_info)
      });
    })

    // æ·»åŠ è‡ªå®šä¹‰æ—¶é—´æ–¹æ³• ä¸æ ‡é¢˜ä¸€è‡´ï¼Œç‚¹å‡»åˆ›å»ºinputè¾“å…¥æ¡†ä¿®æ”¹å€¼ï¼›
    const deadline = document.querySelector('.deadline');
    const localtime = JSON.parse(localStorage.getItem('local_time')) || [];

    // ä»æœ¬åœ°æå–æ—¶é—´ï¼Œåˆå§‹åŒ–deadlineæ—¶é—´ï¼›
    deadline.innerHTML = localtime.fTime + '\xa0' + 'åˆ°è¾¾';
    deadline.addEventListener('click', function (e) {
      const inputTime = document.createElement('input');
      inputTime.type = 'datetime-local';
      inputTime.step = 1;
      // console.log(inputTime)
      deadline.parentNode.replaceChild(inputTime, deadline);
      inputTime.addEventListener('blur', function (e) {
        var time = inputTime.value
        // console.log(time)
        // console.log(typeof time)
        const time2 = time.replace('T', ' ');
        console.log(time2)
        deadline.innerHTML = time2 + '\xa0' + 'åˆ°è¾¾';
        // æ¢å›deadlineèŠ‚ç‚¹
        inputTime.parentNode.replaceChild(deadline, inputTime);
        // å¾—åˆ°å°†æ¥æ—¥æœŸçš„æ—¶é—´æˆ³
        // const time3 = +new Date(time2)
        // console.log(time3);
        // // è¦æŠŠæ—¶é—´å­˜åœ¨æœ¬åœ°å­˜å‚¨
        new_time.fTime = time2;
        localStorage.setItem('local_time', JSON.stringify(new_time));
        // æ‰§è¡Œç¬¬ä¸€æ¬¡å€’è®¡æ—¶
        // getcount();
        // é—´éš”å‡½æ•°æ‰§è¡Œæ¯éš”1ç§’è‡ªåŠ¨æ‰§è¡Œå€’è®¡æ—¶å‡½æ•°
        // setInterval(getcount, 1000)
      })
    })
    console.log(localtime.fTime)
    const f = +new Date(localtime.fTime)
    console.log(f)
    const v = +new Date('2024-9-1 8:00:00')
    console.log(v)

    // å€’è®¡æ—¶å‡½æ•°
    function getcount() {
      // å¾—åˆ°å½“å‰æ—¶é—´æˆ³
      const now = +new Date();
      // å¾—åˆ°æœªæ¥æ—¶é—´æˆ³ï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰
      const future = +new Date(localtime.fTime)
      // console.log(now, future)
      // å¾—åˆ°å‰©ä½™çš„æ—¶é—´æˆ³-æ¯«ç§’æ•°ï¼ŒæŠŠæ¯«ç§’è½¬æ¢ä¸ºç§’
      const count = (future - now) / 1000
      // console.log(count)
      // console.log(parseInt(1.2)) //1
      // console.log(parseInt(1.9)) //1

      let d = parseInt(count / 60 / 60 / 24)
      let h = parseInt(count / 60 / 60 % 24)
      h = h < 10 ? '0' + h : h
      let m = parseInt(count / 60 % 60)
      m = m < 10 ? '0' + m : m
      let s = parseInt(count % 60)
      s = s < 10 ? '0' + s : s

      day.innerHTML = d;
      hour.innerHTML = h;
      min.innerHTML = m;
      second.innerHTML = s;
    }
    // æ‰§è¡Œç¬¬ä¸€æ¬¡å€’è®¡æ—¶
    getcount();
    // é—´éš”å‡½æ•°æ‰§è¡Œæ¯éš”1ç§’è‡ªåŠ¨æ‰§è¡Œå€’è®¡æ—¶å‡½æ•°
    setInterval(getcount, 1000)

  </script>
  <br>
  <hr>
  <h4 id="P125">âœ…Day2å·²åšğŸ…¿ï¸125-ğŸ›‘API-day4-124-å­¦ç”Ÿä¿¡æ¯è¡¨ç»¼åˆæ¡ˆä¾‹ä¸Šä¸‹é›†</h4>
  <br>
  <hr>
  <h4 id="test">ğŸŸ¡è·å–inputè¾“å…¥æ—¶é—´æˆ³å®éªŒ</h4>
  <form action="" class="timecollect">
    <input type="date" class="test">
    <input type="time" class="test" step="1">
    <button class="confirm">ç¡®è®¤</button>
  </form>

  <script>
    const items = document.querySelectorAll('[type]')
    const date = document.querySelector('[type="date"]')
    const time = document.querySelector('[type="time"]')
    const confirm = document.querySelector('.confirm')
    const timecollect = document.querySelector('.timecollect')
    // formè¡¨å•æäº¤äº‹ä»¶
    timecollect.addEventListener('submit', function (e) {
      console.log(e)
      e.preventDefault();
      for (let i = 0; i < items.length; i++) {
        if (items[i].value === '') {
          return alert('æ—¥æœŸæ—¶é—´ä¸èƒ½ä¸ºç©º')
        }
      }
      const plantime = date.value + '\xa0' + time.value;
      console.log(plantime)
      console.log(typeof plantime)
      const newPlan = +new Date(plantime);
      console.log(newPlan);

    })
    // âŒwu2023-4-518:30 æ—¥æœŸæ—¶é—´æ—¶é—´æˆ³ä¸è¡Œï¼ˆä¸­é—´æ— ç©ºæ ¼ï¼‰
    const text3 = +new Date("2023-4-5 18:30")
    console.log(text3)  //NaN
  </script>

  <!-- âœ…2023-4-5 18:30 æ—¥æœŸæ—¶é—´æ—¶é—´æˆ³æˆåŠŸï¼ˆä¸­é—´æ·»åŠ ç©ºæ ¼ï¼‰ -->
  <input type="datetime-local" step="1" class="test4">
  <script>
    const test4 = document.querySelector(".test4")
    test4.addEventListener("blur", function (e) {
      var time = test4.value
      console.log(time)
      console.log(typeof time)
      const time2 = time.replace('T', ' ');
      console.log(time2)
      const time3 = +new Date(time2)
      console.log(time3);

    })
  </script>

</body>

</html>