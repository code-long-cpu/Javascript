<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/WebAPIs_Day_6.css">
  <title>WebAPIs-day6</title>
</head>

<body>
  <h4 id="P143">🅿️142-🛑API-day6-142-注册页面-短信验证码 （①flag节流阀，②icon占位符Background方法，③::before伪类切换自定义icon勾选框）</h4>
  <form action="" class="P142">
    <div class="nameInfo">
      <input type="text" class="name" placeholder="设置用户名称" name="uname" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="telInfo">
      <input type="text" class="tel" placeholder="输入手机号" name="tel" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="checkCode">
      <input type="text" class="message" placeholder="短信验证码" name="checkcode" autocomplete="off">
      <span class="msg"></span>
      <a class='code' href="javascript:;">发送验证码</a>
    </div>
    <div class="passWordInfo">
      <input type="password" class="password" placeholder="设置6至20位字母、数字和符号组合" name="password" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="Agree">
      <input type="password" class="again" placeholder="请再次输入上面密码" name="password" autocomplete="off">
      <span class="msg"></span>
    </div>
    <div class="agreeBOx">
      <!-- <input type="checkbox" class="gouxuan"> -->
      <i class="unChecked"></i>
      <p class="agree"><i></i>已阅读并同意<a href="">《用户服务协议》</a></p>
    </div>
    <button class="next">下 一 步</button>
  </form>
  <script>

    //  0-获取验证码
    const code = document.querySelector('.code');
    let flag = true;
    code.addEventListener('click', function (event) {
      if (flag) {
        flag = false;
        let i = 5;
        code.innerHTML = `${i}秒后重新获取`
        const time = setInterval(function () {
          i--;
          code.innerHTML = `${i}秒后重新获取`
          if (i == 0) {
            clearInterval(time);
            code.innerHTML = `发送验证码`
            flag = true;
          }
        }, 1000)
      }
    })

    // 1-检查用户名字输入格式 用check点击事件
    // 先获name取元素
    const name = document.querySelector('.name');
    name.addEventListener('change', verifynamne);
    // 封装verifynamne函数
    function verifynamne() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = name.nextElementSibling;
      // 制定正则规则
      const reg = /^[a-zA-Z0-9-_]{6,10}$/
      // 验证input与正则是否相等
      if (!reg.test(name.value)) {
        console.log(11);
        span.innerHTML = '输入不合法，请输入6～10位'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    // 2-检查用户手机号输入格式 用check点击事件
    // 先获取元素
    const tel = document.querySelector('.tel');
    tel.addEventListener('change', verifyPhone);
    // 封装verifyPhone函数
    function verifyPhone() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = tel.nextElementSibling;
      // 制定正则规则
      const reg = /^1(3\d|4[5-9]|5[0-35-9]|6[567]|7[0-8]|8\d|9[0-35-9])\d{8}$/
      // 验证input与正则是否相等
      if (!reg.test(tel.value)) {
        // console.log(11);
        span.innerHTML = '输入不合法，请输入11位手机号'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    // 3-检查验证码
    const codeInput = document.querySelector('.message');
    codeInput.addEventListener('change', verifyCode);
    // 封装verifyCode函数
    function verifyCode() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = codeInput.nextElementSibling;
      // 制定正则规则
      const reg = /^\d{6}$/
      // 验证input与正则是否相等
      if (!reg.test(codeInput.value)) {
        // console.log(11);
        span.innerHTML = '输入不合法，请输入6位验证码'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    // 4-检查密码
    const passWord = document.querySelector('.password');
    passWord.addEventListener('change', verifyPassWord);
    // 封装verifyPassWord函数
    function verifyPassWord() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = passWord.nextElementSibling;
      // 制定正则规则
      const reg = /^[a-zA-Z0-9-_]{6,20}$/
      // 验证input与正则是否相等
      if (!reg.test(passWord.value)) {
        // console.log(11);
        span.innerHTML = '输入不合法，请输入6-20密码'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }
    // 5-再次验证密码
    const again = document.querySelector('.again');
    again.addEventListener('change', verifyAgain);
    // 封装verifyPassWord函数
    function verifyAgain() {
      // console.log(11);
      // 获取span元素,使用兄弟选择器
      const span = again.nextElementSibling;
      // 制定正则规则
      // const reg = /^[a-zA-Z0-9-_]{6,20}$/
      // 验证input与正则是否相等
      if (again.value !== passWord.value) {
        // console.log(11);
        span.innerHTML = '两次输入密码不一致'
        return false;
      } else {
        span.innerHTML = ''
        return true;
      }
    }

    //6-勾选框
    const Check = document.querySelector('.unChecked');
    Check.addEventListener('click', function (e) {
      this.classList.toggle('Checked')
    });

    // 7-button提交功能
    const P_142 = document.querySelector('.P142');
    P_142.addEventListener('submit', function (e) {
      if (!Check.classList.contains('Checked')) {
        alert("请勾选《用户服务协议》")
        e.preventDefault()
      }
      //8-form提交功能
      // console.log(verifynamne())
      // 调用函数拿到return
      if (!verifynamne()) e.preventDefault();
      if (!verifyPhone()) e.preventDefault();
      if (!verifyCode()) e.preventDefault();
      if (!verifyPassWord()) e.preventDefault();
      if (!verifyAgain()) e.preventDefault();
    })


  </script>

  <script>
    // 时间函数
    console.log(1);
    // setInterval(function () { console.log(2) }, 5000)
    console.log(3);

  </script>

  <br>
  <hr>
  <h4 id="P144">🅿️134-🛑API-day6-143-注册页面-验证用户名模块</h4>
  <div class="P144">
    <div class="box">
      <div class="tab_bar">
        <a href="javascript:;" class="active" data-id="0">账户登录</a>
        <a href="javascript:;" data-id="0">二维码登录</a>
      </div>
      <div class="tab_pane"></div>
      <div class="tab_pane"></div>
    </div>
  </div>


  <br>
  <hr>
  <h4 id="P145">🅿️144-🛑API-day6-144-综合案例-注册页面-手机号密码</h4>
  <br>
  <hr>
  <h4 id="P146">🅿️145-🛑API-day6-145-综合案例-注册页面-我同意模块</h4>
  <br>
  <hr>
  <h4 id="P147">🅿️146-🛑API-day6-146-阶段案例-登录页面</h4>
  <br>
  <hr>
  <h4 id="P148">🅿️147-🛑API-day6-147-阶段案例-首页制作</h4>
  <br>
  <hr>

  <h4 id="Ptest">🟡input中的icon实验</h4>
  <form action="" class="test0">
    <label for="test1">
      用户名：<input type="text" class="test1" id="test1"><br>
    </label>
    <label for="test2">
      账 &nbsp&nbsp号：<input type="text" class="test2" id="test2"><br>
    </label>
    <label for="test3">
      密 &nbsp&nbsp码：<input type="text" class="test3" id="test3"><br>
    </label>
    <button class="test4">提交</button>
  </form>



</body>

</html>